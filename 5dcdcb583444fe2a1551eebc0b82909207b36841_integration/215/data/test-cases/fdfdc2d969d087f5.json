{
  "uid" : "fdfdc2d969d087f5",
  "name" : "test_connect_no_engine",
  "fullName" : "tests.integration.dbapi.async.test_queries_async#test_connect_no_engine",
  "historyId" : "90aad8dc43fcff6a6d0ccc6dfa09dea1",
  "time" : {
    "start" : 1684940095544,
    "stop" : 1684940096004,
    "duration" : 460
  },
  "description" : "Connecting with engine name is handled properly.",
  "descriptionHtml" : "<p>Connecting with engine name is handled properly.</p>\n",
  "status" : "broken",
  "statusMessage" : "firebolt.utils.exception.OperationalError: Error executing query:\nLine 1, Column 282: Invalid SQL: Type \"DATE_EXT\" does not exist\nselect 1 as uint8, -1 as int_8, 257 as uint16, -257 as int16, 80000 as uint32, -80000 as int32, 30000000000 as uint64, -30000000000 as int64, cast(1.23 AS FLOAT) as float32, 1.2345678901234 as float64, 'text' as \"string\", CAST('2021-03-28' AS DATE) as \"date\", CAST('1860-03-04' AS DATE_EXT) as \"date32\",pgdate '0001-01-01' as \"pgdate\", CAST('2019-07-31 01:01:01' AS DATETIME) as \"datetime\", CAST('2019-07-31 01:01:01.1234' AS TIMESTAMP_EXT(4)) as \"datetime64\", CAST('1111-01-05 17:04:42.123456' as timestampntz) as \"timestampntz\", '1111-01-05 17:04:42.123456'::timestamptz as \"timestamptz\", true as \"boolean\", [1,2,3,4] as \"array\", cast('1231232.123459999990457054844258706536' as decimal(38,30)) as \"decimal\", cast(null as  int) as \"nullable\", 'abc123'::bytea as \"bytea\"\n                                                                                                                                                                                                                                                                                         ^",
  "statusTrace" : "connection_no_engine = <firebolt.async_db.connection.Connection object at 0x7fabdd029210>\nall_types_query = 'select 1 as uint8, -1 as int_8, 257 as uint16, -257 as int16, 80000 as uint32, -80000 as int32, 30000000000 as uint64...90457054844258706536\\' as decimal(38,30)) as \"decimal\", cast(null as  int) as \"nullable\", \\'abc123\\'::bytea as \"bytea\"'\nall_types_query_description = [Column(name='uint8', type_code=<class 'int'>, display_size=None, internal_size=None, precision=None, scale=None, null...int32', type_code=<class 'int'>, display_size=None, internal_size=None, precision=None, scale=None, null_ok=None), ...]\nall_types_query_response = [[1, -1, 257, -257, 80000, -80000, ...]]\ntimezone_name = 'Asia/Calcutta'\n\n    async def test_connect_no_engine(\n        connection_no_engine: Connection,\n        all_types_query: str,\n        all_types_query_description: List[Column],\n        all_types_query_response: List[ColType],\n        timezone_name: str,\n    ) -> None:\n        \"\"\"Connecting with engine name is handled properly.\"\"\"\n        await test_select(\n            connection_no_engine,\n            all_types_query,\n            all_types_query_description,\n            all_types_query_response,\n>           timezone_name,\n        )\n\ntests/integration/dbapi/async/test_queries_async.py:131: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/integration/dbapi/async/test_queries_async.py:156: in test_select\n    assert await c.execute(all_types_query) == 1, \"Invalid row count returned\"\n/opt/hostedtoolcache/Python/3.7.16/x64/lib/python3.7/site-packages/firebolt/async_db/cursor.py:302: in execute\n    await self._do_execute(query, params_list, skip_parsing, async_execution)\n/opt/hostedtoolcache/Python/3.7.16/x64/lib/python3.7/site-packages/firebolt/async_db/cursor.py:250: in _do_execute\n    await self._raise_if_error(resp)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <firebolt.async_db.cursor.Cursor object at 0x7fabde320950>\nresp = <Response [500 Internal Server Error]>\n\n    async def _raise_if_error(self, resp: Response) -> None:\n        \"\"\"Raise a proper error if any\"\"\"\n        if resp.status_code == codes.INTERNAL_SERVER_ERROR:\n            raise OperationalError(\n>               f\"Error executing query:\\n{resp.read().decode('utf-8')}\"\n            )\nE           firebolt.utils.exception.OperationalError: Error executing query:\nE           Line 1, Column 282: Invalid SQL: Type \"DATE_EXT\" does not exist\nE           select 1 as uint8, -1 as int_8, 257 as uint16, -257 as int16, 80000 as uint32, -80000 as int32, 30000000000 as uint64, -30000000000 as int64, cast(1.23 AS FLOAT) as float32, 1.2345678901234 as float64, 'text' as \"string\", CAST('2021-03-28' AS DATE) as \"date\", CAST('1860-03-04' AS DATE_EXT) as \"date32\",pgdate '0001-01-01' as \"pgdate\", CAST('2019-07-31 01:01:01' AS DATETIME) as \"datetime\", CAST('2019-07-31 01:01:01.1234' AS TIMESTAMP_EXT(4)) as \"datetime64\", CAST('1111-01-05 17:04:42.123456' as timestampntz) as \"timestampntz\", '1111-01-05 17:04:42.123456'::timestamptz as \"timestamptz\", true as \"boolean\", [1,2,3,4] as \"array\", cast('1231232.123459999990457054844258706536' as decimal(38,30)) as \"decimal\", cast(null as  int) as \"nullable\", 'abc123'::bytea as \"bytea\"\nE                                                                                                                                                                                                                                                                                                    ^\n\n/opt/hostedtoolcache/Python/3.7.16/x64/lib/python3.7/site-packages/firebolt/async_db/cursor.py:119: OperationalError",
  "flaky" : false,
  "newFailed" : false,
  "beforeStages" : [ {
    "name" : "connection_no_engine",
    "time" : {
      "start" : 1684940095162,
      "stop" : 1684940095542,
      "duration" : 380
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "username",
    "time" : {
      "start" : 1684940094160,
      "stop" : 1684940094160,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "password",
    "time" : {
      "start" : 1684940094161,
      "stop" : 1684940094161,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "event_loop",
    "time" : {
      "start" : 1684940095162,
      "stop" : 1684940095162,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "all_types_query_description",
    "time" : {
      "start" : 1684940095542,
      "stop" : 1684940095542,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "api_endpoint",
    "time" : {
      "start" : 1684940094468,
      "stop" : 1684940094468,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "password_auth",
    "time" : {
      "start" : 1684940094161,
      "stop" : 1684940094467,
      "duration" : 306
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "all_types_query",
    "time" : {
      "start" : 1684940095542,
      "stop" : 1684940095542,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "timezone_name",
    "time" : {
      "start" : 1684940095543,
      "stop" : 1684940095543,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "all_types_query_response",
    "time" : {
      "start" : 1684940095542,
      "stop" : 1684940095543,
      "duration" : 1
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "timezone_offset_seconds",
    "time" : {
      "start" : 1684940095542,
      "stop" : 1684940095542,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "account_name",
    "time" : {
      "start" : 1684940094468,
      "stop" : 1684940094468,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "database_name",
    "time" : {
      "start" : 1684940094151,
      "stop" : 1684940094160,
      "duration" : 9
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  } ],
  "testStage" : {
    "description" : "Connecting with engine name is handled properly.",
    "status" : "broken",
    "statusMessage" : "firebolt.utils.exception.OperationalError: Error executing query:\nLine 1, Column 282: Invalid SQL: Type \"DATE_EXT\" does not exist\nselect 1 as uint8, -1 as int_8, 257 as uint16, -257 as int16, 80000 as uint32, -80000 as int32, 30000000000 as uint64, -30000000000 as int64, cast(1.23 AS FLOAT) as float32, 1.2345678901234 as float64, 'text' as \"string\", CAST('2021-03-28' AS DATE) as \"date\", CAST('1860-03-04' AS DATE_EXT) as \"date32\",pgdate '0001-01-01' as \"pgdate\", CAST('2019-07-31 01:01:01' AS DATETIME) as \"datetime\", CAST('2019-07-31 01:01:01.1234' AS TIMESTAMP_EXT(4)) as \"datetime64\", CAST('1111-01-05 17:04:42.123456' as timestampntz) as \"timestampntz\", '1111-01-05 17:04:42.123456'::timestamptz as \"timestamptz\", true as \"boolean\", [1,2,3,4] as \"array\", cast('1231232.123459999990457054844258706536' as decimal(38,30)) as \"decimal\", cast(null as  int) as \"nullable\", 'abc123'::bytea as \"bytea\"\n                                                                                                                                                                                                                                                                                         ^",
    "statusTrace" : "connection_no_engine = <firebolt.async_db.connection.Connection object at 0x7fabdd029210>\nall_types_query = 'select 1 as uint8, -1 as int_8, 257 as uint16, -257 as int16, 80000 as uint32, -80000 as int32, 30000000000 as uint64...90457054844258706536\\' as decimal(38,30)) as \"decimal\", cast(null as  int) as \"nullable\", \\'abc123\\'::bytea as \"bytea\"'\nall_types_query_description = [Column(name='uint8', type_code=<class 'int'>, display_size=None, internal_size=None, precision=None, scale=None, null...int32', type_code=<class 'int'>, display_size=None, internal_size=None, precision=None, scale=None, null_ok=None), ...]\nall_types_query_response = [[1, -1, 257, -257, 80000, -80000, ...]]\ntimezone_name = 'Asia/Calcutta'\n\n    async def test_connect_no_engine(\n        connection_no_engine: Connection,\n        all_types_query: str,\n        all_types_query_description: List[Column],\n        all_types_query_response: List[ColType],\n        timezone_name: str,\n    ) -> None:\n        \"\"\"Connecting with engine name is handled properly.\"\"\"\n        await test_select(\n            connection_no_engine,\n            all_types_query,\n            all_types_query_description,\n            all_types_query_response,\n>           timezone_name,\n        )\n\ntests/integration/dbapi/async/test_queries_async.py:131: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/integration/dbapi/async/test_queries_async.py:156: in test_select\n    assert await c.execute(all_types_query) == 1, \"Invalid row count returned\"\n/opt/hostedtoolcache/Python/3.7.16/x64/lib/python3.7/site-packages/firebolt/async_db/cursor.py:302: in execute\n    await self._do_execute(query, params_list, skip_parsing, async_execution)\n/opt/hostedtoolcache/Python/3.7.16/x64/lib/python3.7/site-packages/firebolt/async_db/cursor.py:250: in _do_execute\n    await self._raise_if_error(resp)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <firebolt.async_db.cursor.Cursor object at 0x7fabde320950>\nresp = <Response [500 Internal Server Error]>\n\n    async def _raise_if_error(self, resp: Response) -> None:\n        \"\"\"Raise a proper error if any\"\"\"\n        if resp.status_code == codes.INTERNAL_SERVER_ERROR:\n            raise OperationalError(\n>               f\"Error executing query:\\n{resp.read().decode('utf-8')}\"\n            )\nE           firebolt.utils.exception.OperationalError: Error executing query:\nE           Line 1, Column 282: Invalid SQL: Type \"DATE_EXT\" does not exist\nE           select 1 as uint8, -1 as int_8, 257 as uint16, -257 as int16, 80000 as uint32, -80000 as int32, 30000000000 as uint64, -30000000000 as int64, cast(1.23 AS FLOAT) as float32, 1.2345678901234 as float64, 'text' as \"string\", CAST('2021-03-28' AS DATE) as \"date\", CAST('1860-03-04' AS DATE_EXT) as \"date32\",pgdate '0001-01-01' as \"pgdate\", CAST('2019-07-31 01:01:01' AS DATETIME) as \"datetime\", CAST('2019-07-31 01:01:01.1234' AS TIMESTAMP_EXT(4)) as \"datetime64\", CAST('1111-01-05 17:04:42.123456' as timestampntz) as \"timestampntz\", '1111-01-05 17:04:42.123456'::timestamptz as \"timestamptz\", true as \"boolean\", [1,2,3,4] as \"array\", cast('1231232.123459999990457054844258706536' as decimal(38,30)) as \"decimal\", cast(null as  int) as \"nullable\", 'abc123'::bytea as \"bytea\"\nE                                                                                                                                                                                                                                                                                                    ^\n\n/opt/hostedtoolcache/Python/3.7.16/x64/lib/python3.7/site-packages/firebolt/async_db/cursor.py:119: OperationalError",
    "steps" : [ ],
    "attachments" : [ {
      "uid" : "668073c6d02f669f",
      "name" : "log",
      "source" : "668073c6d02f669f.txt",
      "type" : "text/plain",
      "size" : 304
    } ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 1,
    "shouldDisplayMessage" : true,
    "hasContent" : true
  },
  "afterStages" : [ {
    "name" : "connection_no_engine::finalizer",
    "time" : {
      "start" : 1684940096035,
      "stop" : 1684940096036,
      "duration" : 1
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  }, {
    "name" : "event_loop::0",
    "time" : {
      "start" : 1684940096036,
      "stop" : 1684940096036,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "attachmentsCount" : 0,
    "shouldDisplayMessage" : false,
    "hasContent" : false
  } ],
  "labels" : [ {
    "name" : "tag",
    "value" : "asyncio"
  }, {
    "name" : "parentSuite",
    "value" : "tests.integration.dbapi.async"
  }, {
    "name" : "suite",
    "value" : "test_queries_async"
  }, {
    "name" : "host",
    "value" : "fv-az395-180"
  }, {
    "name" : "thread",
    "value" : "2473-MainThread"
  }, {
    "name" : "framework",
    "value" : "pytest"
  }, {
    "name" : "language",
    "value" : "cpython3"
  }, {
    "name" : "package",
    "value" : "tests.integration.dbapi.async.test_queries_async"
  }, {
    "name" : "resultFormat",
    "value" : "allure2"
  } ],
  "parameters" : [ ],
  "links" : [ ],
  "hidden" : false,
  "retry" : false,
  "extra" : {
    "severity" : "normal",
    "retries" : [ ],
    "categories" : [ {
      "name" : "Test defects",
      "matchedStatuses" : [ ],
      "flaky" : false
    } ],
    "tags" : [ "asyncio" ]
  },
  "source" : "fdfdc2d969d087f5.json",
  "parameterValues" : [ ]
}